# EU TRIP TRACKER - Production Deployment Guide
## ComplyEur - Version 1.2.0 - Production Ready

---

## ğŸ“‹ OVERVIEW

The EU Trip Tracker is a secure, offline-first Flask web application designed to help organizations manage employee travel compliance with the Schengen Area's 90/180-day visa-free travel rule.

**Key Features:**
- âœ… Fully offline operation - no internet required after setup
- ğŸ”’ GDPR compliant with automatic data retention policies
- ğŸ“Š Real-time compliance tracking with risk level alerts
- ğŸ’¾ Automatic database backups on startup and shutdown
- ğŸ“¥ Excel import/export capabilities
- ğŸ›¡ï¸ Secure password hashing (Argon2) and session management
- ğŸ“± Responsive, mobile-friendly interface

---

## ğŸš€ QUICK START GUIDE

### Prerequisites
- Windows 10 or later
- Python 3.9 or higher
- 200 MB free disk space

### First-Time Setup

1. **Extract the application folder** to your desired location:
   - Example: `C:\EU_Travel_Tracker\`
   - Or: USB drive, network drive, Desktop, etc.

2. **Double-click `Run_App.bat`**
   - The script will automatically:
     - Check Python installation
     - Create a virtual environment
     - Install all required packages
     - Create configuration files
     - Start the application
     - Open your web browser

3. **Initial Login**
   - The browser will open to: `http://localhost:5000`
   - Default username: **admin**
   - Default password: **admin123**
   - âš ï¸ **IMPORTANT:** Change this password immediately after first login!

4. **Change Admin Password**
   - Click "Change Password" in the sidebar
   - Enter a strong password (minimum 8 characters, mix of letters and numbers)
   - Click "Save Password"

---

## ğŸ” SECURITY & CREDENTIALS

### Default Credentials
```
Username: admin
Password: admin123
```

**âš ï¸ CRITICAL:** Change the default password immediately!

### Password Requirements
- Minimum 8 characters
- Must contain letters and numbers
- Recommended: Use a mix of uppercase, lowercase, numbers, and symbols

### Security Features
- **Argon2** password hashing (industry-standard)
- **Session timeout** after 30 minutes of inactivity
- **Rate limiting** on login attempts (max 5 attempts per 10 minutes)
- **Input validation** to prevent SQL injection and XSS
- **Audit logging** of all admin actions
- **HTTPS-ready** session cookies (enable in settings for HTTPS deployments)

---

## ğŸ’¾ AUTOMATIC BACKUPS

### How It Works
The application automatically creates database backups:

1. **On Startup:** If more than 24 hours have passed since last backup
2. **On Shutdown:** When you close the application (Ctrl+C or close window)
3. **Manual Backup:** Click "Create Backup" in Admin Settings

### Backup Location
```
instance/backups/
```

### Backup Files
Format: `eu_tracker_backup_YYYYMMDD_HHMMSS_<reason>.db`

Example: `eu_tracker_backup_20250115_143022_auto.db`

### Backup Retention
- Maximum 30 backups kept automatically
- Backups older than 90 days are auto-deleted
- You can manually copy important backups to another location

### Restoring from Backup
1. Stop the application
2. Navigate to `instance/backups/`
3. Copy your chosen backup file
4. Replace `eu_tracker.db` with the backup file
5. Restart the application

---

## ğŸ“– USING THE APPLICATION

### Adding Employees
1. Go to **Dashboard**
2. Click **"Add New Employee"**
3. Enter employee name
4. Click **"Add Employee"**

### Adding Trips
1. Click on an employee name
2. Click **"Add Trip"**
3. Select country, entry date, and exit date
4. Click **"Save Trip"**

### Viewing Compliance Status
- **Green:** 30+ days remaining (Safe)
- **Amber:** 10-29 days remaining (Caution)
- **Red:** <10 days remaining (At Risk)

### Importing Excel Data
1. Go to **Import Data** in sidebar
2. Click **"Choose File"**
3. Select your Excel file (.xlsx or .xls)
4. Click **"Upload and Process"**
5. Review the preview
6. Confirm import

**Excel Format:**
```
Column A: Employee Name
Column B: Country Code (e.g., FR, DE, IT)
Column C: Entry Date (YYYY-MM-DD)
Column D: Exit Date (YYYY-MM-DD)
```

### Exporting Data
- **CSV Export:** Dashboard â†’ "Export All Trips (CSV)"
- **PDF Reports:** Employee Detail â†’ "Export PDF Report"
- **DSAR Export:** Privacy Tools â†’ Select employee â†’ "Export Data"

---

## âš™ï¸ CONFIGURATION

### Environment Variables
Edit the `.env` file to customize settings:

```ini
# Security
SECRET_KEY=<auto-generated-on-first-run>
ADMIN_PASSWORD=admin123

# Database
DATABASE_PATH=eu_tracker.db

# Session Settings
SESSION_IDLE_TIMEOUT_MINUTES=30
SESSION_COOKIE_SECURE=False

# Flask Settings
FLASK_ENV=production
FLASK_DEBUG=False
HOST=127.0.0.1
PORT=5000

# GDPR Compliance
RETENTION_MONTHS=36
DSAR_EXPORT_DIR=./exports
AUDIT_LOG_PATH=./logs/audit.log
```

### Admin Settings
Access via **Admin Settings** in the sidebar:

- **Data Retention:** How long to keep old trips (default: 36 months)
- **Session Timeout:** Auto-logout after inactivity (default: 30 minutes)
- **Risk Thresholds:** Customize warning levels for compliance alerts
- **Future Job Warnings:** Set threshold for future trip alerts

---

## ğŸ› ï¸ TROUBLESHOOTING

### Application Won't Start

**Error: "Python is not installed"**
- Install Python 3.9+ from https://www.python.org/downloads/
- Make sure to check "Add Python to PATH" during installation

**Error: "Failed to create virtual environment"**
- Check disk space (need at least 200 MB)
- Try running `Run_App.bat` as Administrator

**Error: "Port 5000 already in use"**
- Close any other applications using port 5000
- Or edit `.env` file and change `PORT=5001`

### Browser Doesn't Open Automatically
- Manually navigate to: http://localhost:5000
- Check Windows Firewall isn't blocking the connection

### Can't Login
- Use default credentials: username `admin`, password `admin123`
- If changed and forgotten, delete `eu_tracker.db` to reset (âš ï¸ deletes all data)

### Excel Import Fails
- Verify Excel file format (must be .xlsx or .xls)
- Check that columns are in correct order
- Ensure dates are in YYYY-MM-DD format
- Country codes must be valid (e.g., FR, DE, IT)

### Data Not Appearing
- Refresh the page (F5)
- Check browser console for errors (F12)
- Verify trips are added to correct employee

---

## ğŸ“‚ FILE STRUCTURE

```
EU_Travel_Tracker/
â”œâ”€â”€ Run_App.bat              # Main startup script (use this)
â”œâ”€â”€ START_APP_SIMPLE.bat     # Quick start (after initial setup)
â”œâ”€â”€ app.py                   # Main Flask application
â”œâ”€â”€ config.py                # Configuration management
â”œâ”€â”€ requirements.txt         # Python dependencies
â”œâ”€â”€ .env                     # Environment variables (create from template)
â”œâ”€â”€ env_template.txt         # Template for .env file
â”œâ”€â”€ README_PRODUCTION.md     # This file
â”‚
â”œâ”€â”€ venv/                    # Virtual environment (auto-created)
â”œâ”€â”€ instance/                # Data and backups
â”‚   â”œâ”€â”€ backups/             # Automatic database backups
â”‚   â”œâ”€â”€ exports/             # DSAR exports
â”‚   â””â”€â”€ logs/                # Audit logs
â”‚
â”œâ”€â”€ data/                    # Reference data (EU entry requirements)
â”œâ”€â”€ static/                  # CSS, JavaScript, images
â”œâ”€â”€ templates/               # HTML templates
â”œâ”€â”€ modules/                 # Business logic modules
â”‚   â””â”€â”€ app/services/        # Core services
â”‚       â”œâ”€â”€ backup.py        # Backup system
â”‚       â”œâ”€â”€ rolling90.py     # 90/180 day calculations
â”‚       â”œâ”€â”€ exports.py       # Export functionality
â”‚       â””â”€â”€ ...              # Other services
â”‚
â”œâ”€â”€ tests/                   # Test suite
â”‚   â””â”€â”€ test_app.py          # Comprehensive tests
â”‚
â””â”€â”€ docs/                    # Extended documentation
```

---

## ğŸ—‘ï¸ UNINSTALLING / MOVING

### To Move the Application
1. Stop the application
2. Copy the entire folder to new location
3. Run `Run_App.bat` in new location
4. All data and settings move with the folder

### To Uninstall
1. Stop the application
2. Delete the entire application folder
3. No registry entries or system files are created

### To Backup Your Data
1. Copy `eu_tracker.db` to safe location
2. Or use **Admin Settings** â†’ **"Create Backup"**
3. Copy backup files from `instance/backups/` folder

---

## ğŸ“Š DATA MANAGEMENT

### GDPR Compliance
The application includes built-in GDPR compliance features:

- **Data Minimization:** Only essential data is stored
- **Right to Access:** DSAR export functionality
- **Right to Erasure:** Delete employee data with one click
- **Right to Rectification:** Edit employee information
- **Data Retention:** Automatic purging of old trip data
- **Audit Logging:** Complete audit trail of all actions

### Retention Policy
- Default: Trips older than 36 months are flagged for deletion
- Configurable in Admin Settings
- Run manual purge from Privacy Tools

### Exporting All Data
1. Go to **Privacy Tools**
2. Select employee
3. Click **"Export Data (DSAR)"**
4. Receive ZIP file with all employee data

---

## ğŸ”§ ADVANCED OPTIONS

### Running on Different Port
Edit `.env` file:
```ini
PORT=5001
```

### Enabling HTTPS (Production)
1. Obtain SSL certificate
2. Configure reverse proxy (nginx/Apache)
3. Edit `.env`:
```ini
SESSION_COOKIE_SECURE=True
```

### Running as Windows Service
1. Install NSSM (Non-Sucking Service Manager)
2. Configure service to run `Run_App.bat`
3. Set to start automatically on boot

---

## ğŸ“ SUPPORT & HELP

### Built-in Help
- Click **"Help & Tutorial"** in the sidebar
- Comprehensive guide to all features
- Visual walkthroughs

### Common Questions

**Q: Can I use this without internet?**
A: Yes! Fully offline after initial setup.

**Q: How many employees can I track?**
A: Unlimited. Tested with 1000+ employees.

**Q: Is my data secure?**
A: Yes. Data stored locally only. Strong encryption. GDPR compliant.

**Q: Can multiple people use it?**
A: Currently single-user (admin only). Multiple users can access simultaneously but share same admin account.

**Q: Does it work on Mac/Linux?**
A: Yes, but requires Python and command-line knowledge. Windows batch files won't work - use `python app.py` directly.

**Q: What countries are tracked?**
A: All Schengen Area countries. Ireland is tracked separately (not part of Schengen).

---

## âœ… TESTING

### Running Tests
From command prompt in application folder:

```bash
venv\Scripts\activate
pytest tests/test_app.py -v
```

### Test Coverage
- Server startup and connectivity
- Authentication and security
- Database operations
- Add/Edit/Delete trips
- 90/180 day calculations
- CSV/PDF exports
- Backup system

---

## ğŸ“ CHANGELOG

### Version 1.2.0 - Production Ready (Current)
- âœ… Automatic backup system (startup/shutdown)
- âœ… 404/500 error pages with proper logging
- âœ… Comprehensive test suite (pytest)
- âœ… Windows deployment scripts (Run_App.bat)
- âœ… Production documentation
- âœ… Enhanced security validation
- âœ… Backup management interface
- âœ… Graceful shutdown handling

### Version 1.1 - Security Review
- Enhanced password hashing (Argon2)
- Input validation and sanitization
- Session security improvements
- Audit logging enhancements

---

## âš–ï¸ LICENSE

This software is provided for internal business use only.
All rights reserved.

---

## ğŸ¯ QUICK REFERENCE

### Keyboard Shortcuts
- **Ctrl+C** in terminal window: Stop application safely
- **F5** in browser: Refresh page
- **F12** in browser: Open developer console (for debugging)

### Default Ports
- Web Interface: http://localhost:5000
- Database: SQLite (file-based, no port needed)

### File Sizes
- Empty database: ~10 KB
- With 100 employees & 1000 trips: ~500 KB
- Backup file: Similar to database size

### Performance
- Page load: <1 second
- Import 1000 trips: ~5-10 seconds
- Backup creation: <1 second

---

**ğŸ‡ªğŸ‡º EU Trip Tracker v1.2.0 - Built with care for compliance and security**
