<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Maavsi Calendar Frontend Diagnostics</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            margin: 20px;
            background: #f5f5f5;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .test-result {
            padding: 10px;
            margin: 5px 0;
            border-radius: 4px;
            font-family: monospace;
        }
        .pass { background: #d4edda; color: #155724; }
        .fail { background: #f8d7da; color: #721c24; }
        .info { background: #d1ecf1; color: #0c5460; }
        button {
            background: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            margin: 10px 5px;
        }
        button:hover { background: #0056b3; }
        #results { margin-top: 20px; }
    </style>
</head>
<body>
    <div class="container">
        <h1>üß™ Maavsi Calendar Frontend Diagnostics</h1>
        <p>This page runs basic diagnostic tests on the calendar frontend components.</p>
        
        <button onclick="runTests()">Run Diagnostics</button>
        <button onclick="clearResults()">Clear Results</button>
        
        <div id="results"></div>
    </div>

    <script type="module">
        // Mock React components for testing
        const React = {
            createElement: (type, props, ...children) => {
                const element = document.createElement(type);
                if (props) {
                    Object.assign(element, props);
                }
                children.forEach(child => {
                    if (typeof child === 'string') {
                        element.textContent = child;
                    } else if (child) {
                        element.appendChild(child);
                    }
                });
                return element;
            }
        };

        // Mock createRoot
        const createRoot = (container) => ({
            render: (element) => {
                container.innerHTML = '';
                container.appendChild(element);
            }
        });

        // Basic diagnostic functions
        function testCalendarShellMounts() {
            console.log('üß™ Testing CalendarShell mounting...');
            
            try {
                const container = document.createElement('div');
                container.style.width = '1200px';
                container.style.height = '600px';
                container.setAttribute('data-testid', 'calendar-shell');
                document.body.appendChild(container);
                
                // Simulate component mounting
                const calendarElement = React.createElement('div', {
                    'data-testid': 'calendar-shell',
                    className: 'calendar-container'
                }, 'Calendar Component');
                
                const root = createRoot(container);
                root.render(calendarElement);
                
                const foundElement = container.querySelector('[data-testid="calendar-shell"]');
                if (foundElement) {
                    console.log('‚úÖ CalendarShell mounted successfully');
                    return true;
                } else {
                    console.log('‚ùå CalendarShell failed to mount - no root element found');
                    return false;
                }
            } catch (error) {
                console.log('‚ùå CalendarShell mounting failed:', error);
                return false;
            }
        }

        function testApiIntegration() {
            console.log('üß™ Testing API integration...');
            
            return fetch('/api/trips')
                .then(response => {
                    if (response.ok) {
                        console.log('‚úÖ API /api/trips responded successfully');
                        return response.json();
                    } else {
                        console.log(`‚ùå API /api/trips returned ${response.status}`);
                        return null;
                    }
                })
                .then(data => {
                    if (data && typeof data === 'object') {
                        console.log('‚úÖ API returned valid JSON data');
                        if (data.trips && Array.isArray(data.trips)) {
                            console.log(`‚úÖ Found ${data.trips.length} trips in API response`);
                        }
                        if (data.employees && Array.isArray(data.employees)) {
                            console.log(`‚úÖ Found ${data.employees.length} employees in API response`);
                        }
                        return true;
                    } else {
                        console.log('‚ùå API returned invalid data');
                        return false;
                    }
                })
                .catch(error => {
                    console.log('‚ùå API integration failed:', error);
                    return false;
                });
        }

        function testComponentRendering() {
            console.log('üß™ Testing component rendering...');
            
            try {
                const container = document.createElement('div');
                container.style.width = '1200px';
                container.style.height = '600px';
                document.body.appendChild(container);
                
                // Create a mock calendar component
                const calendarComponent = React.createElement('div', {
                    className: 'calendar-container',
                    style: { width: '100%', height: '100%' }
                }, 
                    React.createElement('div', { className: 'calendar-header' }, 'Calendar Header'),
                    React.createElement('div', { className: 'calendar-body' }, 'Calendar Body'),
                    React.createElement('div', { className: 'trip-layer' }, 'Trip Layer')
                );
                
                const root = createRoot(container);
                root.render(calendarComponent);
                
                const tripElements = container.querySelectorAll('.trip-layer, .calendar-body');
                console.log(`‚úÖ Components rendered with ${tripElements.length} elements`);
                return true;
            } catch (error) {
                console.log('‚ùå Component rendering failed:', error);
                return false;
            }
        }

        function testErrorHandling() {
            console.log('üß™ Testing error handling...');
            
            try {
                // Test with invalid operations
                const container = document.createElement('div');
                document.body.appendChild(container);
                
                // This should not throw
                const root = createRoot(container);
                root.render(React.createElement('div', null, 'Test'));
                
                console.log('‚úÖ Error handling working correctly');
                return true;
            } catch (error) {
                console.log('‚ùå Error handling test failed:', error);
                return false;
            }
        }

        async function runDiagnostics() {
            console.log('üöÄ Starting Maavsi Calendar Frontend Diagnostics...');
            console.log('================================================');
            
            const results = {
                calendarShellMounts: testCalendarShellMounts(),
                componentRendering: testComponentRendering(),
                errorHandling: testErrorHandling(),
                apiIntegration: await testApiIntegration()
            };
            
            console.log('================================================');
            console.log('üìä Diagnostic Results:');
            console.log(`CalendarShell Mounts: ${results.calendarShellMounts ? '‚úÖ' : '‚ùå'}`);
            console.log(`Component Rendering: ${results.componentRendering ? '‚úÖ' : '‚ùå'}`);
            console.log(`Error Handling: ${results.errorHandling ? '‚úÖ' : '‚ùå'}`);
            console.log(`API Integration: ${results.apiIntegration ? '‚úÖ' : '‚ùå'}`);
            
            const allPassed = Object.values(results).every(result => result === true);
            console.log(`Overall Status: ${allPassed ? '‚úÖ ALL TESTS PASSED' : '‚ùå SOME TESTS FAILED'}`);
            
            return results;
        }

        // Make functions available globally
        window.runTests = async function() {
            const resultsDiv = document.getElementById('results');
            resultsDiv.innerHTML = '<div class="test-result info">Running diagnostics...</div>';
            
            try {
                const results = await runDiagnostics();
                
                let html = '<h3>Test Results:</h3>';
                html += `<div class="test-result ${results.calendarShellMounts ? 'pass' : 'fail'}">CalendarShell Mounts: ${results.calendarShellMounts ? '‚úÖ PASS' : '‚ùå FAIL'}</div>`;
                html += `<div class="test-result ${results.componentRendering ? 'pass' : 'fail'}">Component Rendering: ${results.componentRendering ? '‚úÖ PASS' : '‚ùå FAIL'}</div>`;
                html += `<div class="test-result ${results.errorHandling ? 'pass' : 'fail'}">Error Handling: ${results.errorHandling ? '‚úÖ PASS' : '‚ùå FAIL'}</div>`;
                html += `<div class="test-result ${results.apiIntegration ? 'pass' : 'fail'}">API Integration: ${results.apiIntegration ? '‚úÖ PASS' : '‚ùå FAIL'}</div>`;
                
                const allPassed = Object.values(results).every(result => result === true);
                html += `<div class="test-result ${allPassed ? 'pass' : 'fail'}"><strong>Overall Status: ${allPassed ? '‚úÖ ALL TESTS PASSED' : '‚ùå SOME TESTS FAILED'}</strong></div>`;
                
                resultsDiv.innerHTML = html;
            } catch (error) {
                resultsDiv.innerHTML = `<div class="test-result fail">Error running tests: ${error.message}</div>`;
            }
        };

        window.clearResults = function() {
            document.getElementById('results').innerHTML = '';
        };
    </script>
</body>
</html>




